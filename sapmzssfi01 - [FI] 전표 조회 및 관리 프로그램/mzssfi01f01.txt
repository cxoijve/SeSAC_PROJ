*&---------------------------------------------------------------------*
*&      Form  GET_DATA
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM GET_DATA .

  PERFORM GET_JEH_DATA.     " 전표 헤더 정보 취득
  PERFORM MODIFY_DATA.      " 추가 정보 취득


ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  CREATE_ALV_0100
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM CREATE_ALV_0100 .

  " 객체가 있을 시 미생성
  IF GO_CON IS NOT INITIAL.
    RETURN.
  ENDIF.

  CREATE OBJECT GO_CON
    EXPORTING
*     PARENT                      =
      CONTAINER_NAME              = 'CON'
*     STYLE                       =
*     LIFETIME                    = lifetime_default
*     REPID                       =
*     DYNNR                       =
*     NO_AUTODEF_PROGID_DYNNR     =
    EXCEPTIONS
      CNTL_ERROR                  = 1
      CNTL_SYSTEM_ERROR           = 2
      CREATE_ERROR                = 3
      LIFETIME_ERROR              = 4
      LIFETIME_DYNPRO_DYNPRO_LINK = 5
      OTHERS                      = 6.
  IF SY-SUBRC <> 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CREATE OBJECT GO_ALV
    EXPORTING
*     I_SHELLSTYLE      = 0
*     I_LIFETIME        =
      I_PARENT          = GO_CON
*     I_APPL_EVENTS     = space
*     I_PARENTDBG       =
*     I_APPLOGPARENT    =
*     I_GRAPHICSPARENT  =
*     I_NAME            =
*     I_FCAT_COMPLETE   = SPACE
    EXCEPTIONS
      ERROR_CNTL_CREATE = 1
      ERROR_CNTL_INIT   = 2
      ERROR_CNTL_LINK   = 3
      ERROR_DP_CREATE   = 4
      OTHERS            = 5.
  IF SY-SUBRC <> 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

*  "Event Register
*  PERFORM REQ_EVENT_FOR_ALV.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_LAYO
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_LAYO .

  CLEAR GS_LAYO.

  GS_LAYO-CWIDTH_OPT = 'X'.
  GS_LAYO-ZEBRA = 'X'.
  GS_LAYO-SEL_MODE = 'A'.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_FCAT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_FCAT .
  CLEAR: GT_FCAT, GS_FCAT.

  " 전표번호
  GS_FCAT-FIELDNAME = 'JENUM'.
  GS_FCAT-COL_POS = '1'.
  GS_FCAT-COLTEXT = '전표번호'.
  APPEND GS_FCAT TO GT_FCAT.

  " 회계연도
  CLEAR GS_FCAT.
  GS_FCAT-FIELDNAME = 'FYEAR'.
  GS_FCAT-COL_POS = '2'.
  GS_FCAT-COLTEXT = '회계연도'.
  APPEND GS_FCAT TO GT_FCAT.

  " 전표 유형
  CLEAR GS_FCAT.
  GS_FCAT-FIELDNAME = 'JTYPE'.
  GS_FCAT-COL_POS = 2.
  GS_FCAT-COLTEXT = '전표 유형'.
  APPEND GS_FCAT TO GT_FCAT.

  " 비고
  CLEAR: GS_FCAT.
  GS_FCAT-FIELDNAME = 'STEXT'.
  GS_FCAT-COL_POS = 3.
  GS_FCAT-COLTEXT = '비고'.
  APPEND GS_FCAT TO GT_FCAT.

  " 통화 키
  CLEAR GS_FCAT.
  GS_FCAT-FIELDNAME = 'CURKY'.
  GS_FCAT-COL_POS = 4.
  GS_FCAT-COLTEXT = '통화 키'.
  APPEND GS_FCAT TO GT_FCAT.

  " 전기일
  CLEAR: GS_FCAT.
  GS_FCAT-FIELDNAME = 'RGDAT'.
  GS_FCAT-COL_POS = 5.
  GS_FCAT-COLTEXT = '전기일'.
  APPEND GS_FCAT TO GT_FCAT.

  " 등록자
  CLEAR GS_FCAT.
  GS_FCAT-FIELDNAME = 'RGTOR'.
  GS_FCAT-COL_POS = 6.
  GS_FCAT-COLTEXT = '등록자'.
  APPEND GS_FCAT TO GT_FCAT.

  " 따로 뺄 예정
***  " 역분개 여부
***  CLEAR GS_FCAT.
***  GS_FCAT-FIELDNAME = 'REV'.
***  GS_FCAT-COL_POS = 8.
***  GS_FCAT-COLTEXT = '역분개 여부'.
***  APPEND GS_FCAT TO GT_FCAT.
***
***  " 역분개 사유
***  CLEAR GS_FCAT.
***  GS_FCAT-FIELDNAME = 'RRSON'.
***  GS_FCAT-COL_POS = 9.
***  GS_FCAT-COLTEXT = '역분개 사유'.
***  APPEND GS_FCAT TO GT_FCAT.
***
***  " 역분개 전표번호
***  CLEAR GS_FCAT.
***  GS_FCAT-FIELDNAME = 'RJNUM'.
***  GS_FCAT-COL_POS = 9.
***  GS_FCAT-COLTEXT = '역분개 전표번호'.
***  APPEND GS_FCAT TO GT_FCAT.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_SORT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_SORT .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  CREATE_ALV_0200
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM CREATE_ALV_0200 .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  DISPLAY_ALV_0200
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM DISPLAY_ALV_0200 .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_JEH_DATA
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM GET_JEH_DATA .
  CLEAR: GS_HDATA, GT_HDATA.

  IF ZSSSFI0101-JENUM IS INITIAL.

    SELECT JENUM FYEAR JTYPE STEXT CURKY RGDAT
           RGTOR REV RRSON RJNUM
       FROM ZTSSJEH
         INTO CORRESPONDING FIELDS OF TABLE GT_HDATA.


  ELSE.

    SELECT JENUM FYEAR JTYPE STEXT CURKY RGDAT
           RGTOR REV RRSON RJNUM
       FROM ZTSSJEH
         INTO CORRESPONDING FIELDS OF TABLE GT_HDATA
    WHERE JENUM = ZSSSFI0101-JENUM.

  ENDIF.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  MODIFY_DATA
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM MODIFY_DATA .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_FCAT_0300
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_FCAT_0300 .

  CLEAR: GT_FCAT, GS_FCAT.

  " 전표 아이템 번호
  GS_FCAT-FIELDNAME = 'JESEQ'.
  GS_FCAT-COL_POS = '1'.
  GS_FCAT-COLTEXT = '라인번호'.
  APPEND GS_FCAT TO GT_FCAT.

  " G/L 계정
  CLEAR GS_FCAT.
  GS_FCAT-FIELDNAME = 'GLACC'.
  GS_FCAT-COL_POS = '2'.
  GS_FCAT-COLTEXT = 'G/L 계정'.
  APPEND GS_FCAT TO GT_FCAT.

  " 차변
  CLEAR GS_FCAT.
  GS_FCAT-FIELDNAME = 'DEBIT'.
  GS_FCAT-COL_POS = 2.
  GS_FCAT-COLTEXT = '차변'.
  APPEND GS_FCAT TO GT_FCAT.

  " 대변
  CLEAR: GS_FCAT.
  GS_FCAT-FIELDNAME = 'CREDIT'.
  GS_FCAT-COL_POS = 3.
  GS_FCAT-COLTEXT = '대변'.
  APPEND GS_FCAT TO GT_FCAT.

  " 통화 키
  CLEAR GS_FCAT.
  GS_FCAT-FIELDNAME = 'CURKY'.
  GS_FCAT-COL_POS = 4.
  GS_FCAT-COLTEXT = '통화 키'.
  APPEND GS_FCAT TO GT_FCAT.

**    " B/P 유형
**    CLEAR: GS_FCAT.
**    GS_FCAT-FIELDNAME = 'RGDAT'.
**    GS_FCAT-COL_POS = 5.
**    GS_FCAT-COLTEXT = '전기일'.
**    APPEND GS_FCAT TO GT_FCAT.
**
**    " 거래처 코드
**    CLEAR GS_FCAT.
**    GS_FCAT-FIELDNAME = 'RGTOR'.
**    GS_FCAT-COL_POS = 6.
**    GS_FCAT-COLTEXT = '거래처 코드'.
**    APPEND GS_FCAT TO GT_FCAT.
**
**    " 거래처명
**    CLEAR GS_FCAT.
**    GS_FCAT-FIELDNAME = 'RGTOR'.
**    GS_FCAT-COL_POS = 6.
**    GS_FCAT-COLTEXT = '거래처명'.
**    APPEND GS_FCAT TO GT_FCAT.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  CREATE_ALV_0300
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM CREATE_ALV_0300 .

  " 객체가 있을 시 미생성
  IF GO_CON2 IS NOT INITIAL.
    RETURN.
  ENDIF.

  CREATE OBJECT GO_CON2
    EXPORTING
*     PARENT                      =
      CONTAINER_NAME              = 'CON2'
*     STYLE                       =
*     LIFETIME                    = lifetime_default
*     REPID                       =
*     DYNNR                       =
*     NO_AUTODEF_PROGID_DYNNR     =
    EXCEPTIONS
      CNTL_ERROR                  = 1
      CNTL_SYSTEM_ERROR           = 2
      CREATE_ERROR                = 3
      LIFETIME_ERROR              = 4
      LIFETIME_DYNPRO_DYNPRO_LINK = 5
      OTHERS                      = 6.
  IF SY-SUBRC <> 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CREATE OBJECT GO_ALV2
    EXPORTING
*     I_SHELLSTYLE      = 0
*     I_LIFETIME        =
      I_PARENT          = GO_CON2
*     I_APPL_EVENTS     = space
*     I_PARENTDBG       =
*     I_APPLOGPARENT    =
*     I_GRAPHICSPARENT  =
*     I_NAME            =
*     I_FCAT_COMPLETE   = SPACE
    EXCEPTIONS
      ERROR_CNTL_CREATE = 1
      ERROR_CNTL_INIT   = 2
      ERROR_CNTL_LINK   = 3
      ERROR_DP_CREATE   = 4
      OTHERS            = 5.
  IF SY-SUBRC <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  DISPLAY_ALV_0300
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM DISPLAY_ALV_0300 .

  CALL METHOD GO_ALV2->SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
*     I_BUFFER_ACTIVE =
*     I_BYPASSING_BUFFER   =
*     I_CONSISTENCY_CHECK  =
*     I_STRUCTURE_NAME     =
*     IS_VARIANT      =
*     I_SAVE          =
*     I_DEFAULT       = 'X'
      IS_LAYOUT       = GS_LAYO
*     IS_PRINT        =
*     IT_SPECIAL_GROUPS    =
*     IT_TOOLBAR_EXCLUDING = GT_EXCLUDE
*     IT_HYPERLINK    =
*     IT_ALV_GRAPHICS =
*     IT_EXCEPT_QINFO =
*     IR_SALV_ADAPTER =
    CHANGING
      IT_OUTTAB       = GT_IDATA
      IT_FIELDCATALOG = GT_FCAT
      IT_SORT         = GT_SORT
*     IT_FILTER       =
*  EXCEPTIONS
*     INVALID_PARAMETER_COMBINATION = 1
*     PROGRAM_ERROR   = 2
*     TOO_MANY_LINES  = 3
*     OTHERS          = 4
    .
  IF SY-SUBRC <> 0.
* Implement suitable error handling here
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_SELECTED_ROWS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      <--P_GT_ROWS  text
*----------------------------------------------------------------------*
FORM GET_SELECTED_ROWS  CHANGING PT_ROWS TYPE LVC_T_ROW.

  CLEAR: PT_ROWS.

  CALL METHOD GO_ALV->GET_SELECTED_ROWS
    IMPORTING
      ET_INDEX_ROWS = PT_ROWS.

ENDFORM.

----------------------------------------------------------------------------------
Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750
