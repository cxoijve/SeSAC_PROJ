*&---------------------------------------------------------------------*
*&  Include           ZRBSSMD03F01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Form  INITIALIZATION
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM INITIALIZATION .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  AT_SELECTION_SCREEN_OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM AT_SELECTION_SCREEN_OUTPUT .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  AT_SELECTION_SCREEN
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM AT_SELECTION_SCREEN .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  START_OF_SELECTION
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM START_OF_SELECTION .
  DATA: LT_ALSMEX TYPE TABLE OF ALSMEX_TABLINE.


  CALL FUNCTION 'ALSM_EXCEL_TO_INTERNAL_TABLE'
    EXPORTING
      FILENAME                = PA_FILE  " 받아온 파일 "
      I_BEGIN_COL             = 1        " 시작 할 열번호 "
      I_BEGIN_ROW             = 2        " 시작 할 행번호 "
      I_END_COL               = 256      " 명시한 필드갯수 "
      I_END_ROW               = 100000   " 최대 행갯수 "
    TABLES
      INTERN                  = LT_ALSMEX " 해당 테이블에 값 넣기. "
    EXCEPTIONS
      INCONSISTENT_PARAMETERS = 1
      UPLOAD_OLE              = 2
      OTHERS                  = 3.


  DATA: LT_DFIES TYPE TABLE OF DFIES.

  CALL FUNCTION 'DDIF_FIELDINFO_GET'
    EXPORTING
      TABNAME   = 'ZSSSMD0303'
    TABLES
      DFIES_TAB = LT_DFIES.


  LOOP AT LT_ALSMEX INTO DATA(LS_ALSMEX).

    ASSIGN COMPONENT LS_ALSMEX-COL OF STRUCTURE GS_EXCEL TO FIELD-SYMBOL(<FS_FIELD>).

    READ TABLE LT_DFIES INTO DATA(LS_DFIES) INDEX LS_ALSMEX-COL.

    IF SY-SUBRC EQ 0.
      CASE LS_DFIES-INTTYPE.
*        WHEN 'P'.
*          REPLACE ALL OCCURRENCES OF ',' IN LS_ALSMEX-VALUE  WITH SPACE.
        WHEN 'D'.
          REPLACE ALL OCCURRENCES OF '.' IN LS_ALSMEX-VALUE WITH ''.
*          REPLACE ALL OCCURRENCES OF '-' IN LS_ALSMEX-VALUE  WITH SPACE.
        WHEN OTHERS.

      ENDCASE.

      IF LS_DFIES-CONVEXIT IS NOT INITIAL.
        DATA(FUNCTION_NAME) = 'CONVERSION_EXIT_' && LS_DFIES-CONVEXIT && '_INPUT'.

        CALL FUNCTION FUNCTION_NAME
          EXPORTING
            INPUT  = LS_ALSMEX-VALUE
          IMPORTING
            OUTPUT = LS_ALSMEX-VALUE.

      ENDIF.

      <FS_FIELD> = LS_ALSMEX-VALUE.
    ENDIF.


    AT END OF ROW.
      APPEND GS_EXCEL TO GT_EXCEL.
    ENDAT.

  ENDLOOP.


ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_FILE
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      <--P_PA_FILE  text
*----------------------------------------------------------------------*
FORM GET_FILE  CHANGING PA_FILE.

  DATA LV_STRING TYPE STRING.

  CALL METHOD CL_GUI_FRONTEND_SERVICES=>DIRECTORY_BROWSE
    EXPORTING
      WINDOW_TITLE    = 'TEST'              " Title of Browsing Window
*     INITIAL_FOLDER  = PA_FUP                 " Start Browsing Here
    CHANGING
      SELECTED_FOLDER = LV_STRING                 " Folder Selected By User
*        EXCEPTIONS
*     CNTL_ERROR      = 1                " Control error
*     ERROR_NO_GUI    = 2                " No GUI available
*     NOT_SUPPORTED_BY_GUI = 3                " GUI does not support this
*     OTHERS          = 4
    .

  PA_FILE = LV_STRING.

  CALL FUNCTION 'WS_FILENAME_GET'
    EXPORTING
      MASK             = ' '
      MODE             = ' '
      TITLE            = ' '
    IMPORTING
      FILENAME         = PA_FILE
    EXCEPTIONS
      INV_WINSYS       = 1
      NO_BATCH         = 2
      SELECTION_CANCEL = 3
      SELECTION_ERROR  = 4
      OTHERS           = 5.

  IF SY-SUBRC = 0.
    MESSAGE '엑셀 파일을 선택하셨습니다.' TYPE 'S'.
  ELSE.
    MESSAGE '선택한 파일을 확인해주세요.' TYPE 'I'.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  BDC
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM BDC USING
     VALUE(P_SCREEN)
     VALUE(P_NAME)
     VALUE(P_VALUE).

  DATA LS_BDCDATA TYPE BDCDATA.


  IF P_SCREEN EQ 'X'.
    LS_BDCDATA-DYNBEGIN = P_SCREEN.  " BDC screen start "
    LS_BDCDATA-PROGRAM  = P_NAME.    " BDC Program "
    LS_BDCDATA-DYNPRO   = P_VALUE.   " BDC Screen Number "
  ELSE.
    LS_BDCDATA-FNAM     = P_NAME.    " Field Name "
    LS_BDCDATA-FVAL     = P_VALUE. " BDC Field Value "
  ENDIF.

  APPEND LS_BDCDATA TO GT_BDC.

  CLEAR LS_BDCDATA.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  CREATE_ALV_0100
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM CREATE_ALV_0100 .

  " 객체가 있을 시 미생성
  IF GO_CON IS NOT INITIAL.
    RETURN.
  ENDIF.

  CREATE OBJECT GO_CON
    EXPORTING
      CONTAINER_NAME              = 'CON'
    EXCEPTIONS
      CNTL_ERROR                  = 1
      CNTL_SYSTEM_ERROR           = 2
      CREATE_ERROR                = 3
      LIFETIME_ERROR              = 4
      LIFETIME_DYNPRO_DYNPRO_LINK = 5
      OTHERS                      = 6.
  IF SY-SUBRC <> 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CREATE OBJECT GO_ALV
    EXPORTING
      I_PARENT          = GO_CON
    EXCEPTIONS
      ERROR_CNTL_CREATE = 1
      ERROR_CNTL_INIT   = 2
      ERROR_CNTL_LINK   = 3
      ERROR_DP_CREATE   = 4
      OTHERS            = 5.
  IF SY-SUBRC <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  DISPLAY_ALV_0100
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM DISPLAY_ALV_0100 .

***  IF GT_FCAT IS INITIAL.
***    MESSAGE '필드 카탈로그가 비어있음. 구조체 이름 확인 필요' TYPE 'E'.
***  ENDIF.

  CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      I_STRUCTURE_NAME = 'ZSSSMD0303'
**      IS_LAYOUT       = GS_LAYO
    CHANGING
      IT_OUTTAB        = GT_EXCEL
**      IT_FIELDCATALOG = GT_FCAT
**      IT_SORT         = GT_SORT
*  EXCEPTIONS
*     INVALID_PARAMETER_COMBINATION = 1
*     PROGRAM_ERROR    = 2
*     TOO_MANY_LINES   = 3
*     OTHERS           = 4
    .
  IF SY-SUBRC <> 0.
* Implement suitable error handling here
  ENDIF.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_LAYO
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_LAYO .
  CLEAR GS_LAYO.
  GS_LAYO-ZEBRA = 'X'.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_SORT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_SORT .

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_FCAT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_FCAT .
ENDFORM.

----------------------------------------------------------------------------------
Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750
