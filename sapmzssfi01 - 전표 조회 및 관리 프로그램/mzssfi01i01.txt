*&---------------------------------------------------------------------*
*&  Include           MZSSFI01I01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  EXIT  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE EXIT INPUT.

  CASE OK_CODE.
    WHEN 'EXIT'.
      LEAVE PROGRAM.

    WHEN 'CANC'.
      LEAVE TO SCREEN 0.
  ENDCASE.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.

  CASE OK_CODE.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.

    WHEN 'ENTER'.

      " 등록자명 취득
      PERFORM GET_RGTOR_NAME USING ZSSSFI0101-RGTOR
                             CHANGING ZSSSFI0101-RGTOR_T.

      PERFORM CHECK_RGTOR_DEPID USING ZSSSFI0101-RGTOR.





    WHEN 'HINFO'.
      " 헤더 정보 변경 버튼
      PERFORM CHANGE_ALV_MODE.


    WHEN 'SEARCH'.

      " 회계전표번호가 입력되었을 경우, 회계연도와 무조건 함께 오도록
      IF ZSSSFI0101-FYEAR IS INITIAL AND ZSSSFI0101-JENUM IS NOT INITIAL.
*        MESSAGE
        RETURN.
      ENDIF.

      " 전표 조회
      PERFORM SET_DATA_0100.

      PERFORM GET_DATA.

    WHEN 'REGIST'.
      " 전표 생성
      PERFORM SET_DATA_0200.

      CALL SCREEN 0200.

    WHEN 'DETAIL'.
      " 전표 상세조회
      PERFORM SEL_ROWS.

      PERFORM SET_DATA_0300.

      CALL SCREEN 0300.

    WHEN 'INIT'.
      " 새로고침
      CLEAR: ZSSSFI0101, GT_HDATA.


      PERFORM SET_INIT.


    WHEN OTHERS.

  ENDCASE.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0200  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0200 INPUT.
*  TABSTRIP-ACTIVETAB = OK_CODE.

  CASE OK_CODE.
    WHEN 'BACK'.
      CLEAR: ZSSSFI0102, GT_IDATA.
      LEAVE TO SCREEN 0.

    WHEN 'ENTER'.

      " 필수값 유효성 체크
      IF ZSSSFI0102-RGTOR IS INITIAL OR
         ZSSSFI0102-JTYPE IS INITIAL OR
         ZSSSFI0102-RGDAT IS INITIAL.
        MESSAGE S999(ZMCSS) WITH '등록자, 전표유형, 전기일을 모두 입력해 주세요.'
         DISPLAY LIKE 'E'.
        RETURN.
      ENDIF.


      PERFORM GET_RGTOR_NAME USING ZSSSFI0102-RGTOR
                             CHANGING ZSSSFI0102-RGTOR_T.

      PERFORM CHECK_RGTOR_DEPID USING ZSSSFI0102-RGTOR.




    WHEN 'INSERT'.

      " 채번 후 생성
      PERFORM CHECK_DATA_0200 CHANGING GV_SUBRC.
      IF GV_SUBRC = 4.
        CLEAR GV_SUBRC.
        RETURN.
      ENDIF.

      PERFORM INSERT_DATA.


    WHEN 'CLEAR'.
      " 초기화

    WHEN 'BADD'.
      IF ZSSSFI0102-RGTOR IS INITIAL
        OR ZSSSFI0102-JTYPE IS INITIAL
        OR ZSSSFI0102-RGDAT IS INITIAL.

        MESSAGE S999(ZMCSS) WITH '등록자, 전표유형, 전기일을 모두 입력해 주세요.'
              DISPLAY LIKE 'E'.
        RETURN.
      ENDIF.


      ZSSSFI0103-CURKY = 'KRW'.

      CALL SCREEN 210 STARTING AT 5 5 ENDING AT 120 30.


    WHEN 'BEDIT'.
      " 라인아이템 수정
* ALV EDIT





    WHEN 'BDEL'.
      " 라인아이템 삭제
* ALV EDIT



    WHEN OTHERS.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0300  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0300 INPUT.

  CASE OK_CODE.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.

    WHEN 'ENTER'.

      " 등록자명 취득
      PERFORM GET_RGTOR_NAME USING ZSSSFI0102-RGTOR
                             CHANGING ZSSSFI0102-RGTOR_T.

  ENDCASE.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0101  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0101 INPUT.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0102  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0102 INPUT.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  EXIT_MODAL  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE EXIT_MODAL INPUT.

  CASE OK_CODE.
    WHEN 'EXIT'.
      LEAVE PROGRAM.

    WHEN 'CANC' OR 'CLOSE'.
      LEAVE TO SCREEN 0.

    WHEN OTHERS.

  ENDCASE.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0210  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0210 INPUT.

  CASE OK_CODE.
    WHEN 'SAVE'.
*      GV_SUB = 'SAVE'.

      " 입력된 정보 ALV로 넘기기
      PERFORM SET_JEI_DATA.


      " 차/대변 총 금액

      DATA: LV_DEBIT2  TYPE ZSSSFI0103-DEBIT,
            LV_CREDIT2 TYPE ZSSSFI0103-CREDIT.

      CLEAR: LV_DEBIT2, LV_CREDIT2.
      LOOP AT GT_IDATA INTO DATA(LS_IDATA).
        LV_DEBIT2 = LV_DEBIT2 + LS_IDATA-DEBIT.
        LV_CREDIT2 = LV_CREDIT2 + LS_IDATA-CREDIT.
      ENDLOOP.

      ZSSSFI0103-DEBIT = LV_DEBIT2.
      ZSSSFI0103-CREDIT = LV_CREDIT2.


      LEAVE TO SCREEN 0.

    WHEN 'CLOSE'.
      LEAVE TO SCREEN 0.

    WHEN 'CHECK'.
      " G/L 계정명 취득
      PERFORM GET_GL_NAME USING ZSSSFI0103-GLACC
                          CHANGING ZSSSFI0103-ACTNM.


    WHEN OTHERS.

  ENDCASE.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0201  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0201 INPUT.

  CASE SY-UCOMM.
    WHEN 'ENTER'.

    WHEN 'SAVE'.
      " ZSSSFI0103 전표 라인 정보가 alv에 반영되도록
      " GT_IDATA.

    WHEN 'EDIT'.

    WHEN 'DELETE'.


  ENDCASE.

ENDMODULE.

----------------------------------------------------------------------------------
Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750
