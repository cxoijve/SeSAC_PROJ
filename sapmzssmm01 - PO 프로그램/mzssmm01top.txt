*&---------------------------------------------------------------------*
*& Include MZSSMM01TOP                                       Module Pool      SAPMZSSMM01
*&
*&---------------------------------------------------------------------*
PROGRAM sapmzssmm01.

" 공통변수
DATA : ok_code  TYPE sy-ucomm,
       gv_subrc TYPE sy-subrc,
       gv_dynnr TYPE sy-dynnr.

" 도메인 변수
DATA : gt_domain TYPE dd07v_t,
       gs_domain LIKE LINE OF gt_domain.

DATA : gv_chk1(1),
       gv_chk2(1),
       gv_chk3(1).

*-------------------------------------------------------*
* 100번 스크린 관련 변수들
*-------------------------------------------------------*

" 100번 alv 상세 조건 설정
DATA : go_con TYPE REF TO cl_gui_custom_container,
       go_alv TYPE REF TO cl_gui_alv_grid.

DATA : gs_layo TYPE lvc_s_layo,
       gt_fcat TYPE lvc_t_fcat,
       gs_fcat TYPE lvc_s_fcat,
       gt_sort TYPE lvc_t_sort,
       gs_sort TYPE lvc_s_sort.

" 100번 스크린 조회조건
TABLES : zsssmm0101.
DATA : gs_cond TYPE zsssmm0101.

" 100번 스크린 - 모든 PO 조회 결과


DATA : BEGIN OF gs_data,
         light type char8.
    INCLUDE TYPE zsssmm0102.
DATA : END OF gs_data,
gt_data LIKE TABLE OF gs_data.


*DATA : gt_data TYPE zsssmm0102_t,
*       gs_data LIKE LINE OF gt_data.

*-------------------------------------------------------*
* 100번 스크린 - 구매오더 전체 조회
*-------------------------------------------------------*

DATA : BEGIN OF gs_itamt,
         ponum  TYPE ztssgri-ponum,
         itnum  TYPE ztssgri-itnum,
         amount TYPE ztssgri-amount,
       END OF gs_itamt,
       gt_itamt LIKE TABLE OF gs_itamt.

*-------------------------------------------------------*
* 200번 스크린 관련 변수들 & 구매오더 생성
*-------------------------------------------------------*

" Po 번호, po 날짜
DATA : gr_ponum TYPE RANGE OF ztsspoh-ponum,
       gr_podat TYPE RANGE OF ztsspoh-podat.

" 구매오더 헤더
TABLES : zsssmm0103.
*DATA : gs_cond_head TYPE zsssmm0103.
DATA: BEGIN OF gs_cond_head,
        ponum    TYPE     zessponum,
        podat    TYPE     zesspodat,
        venid    TYPE     zessvenid,
        vname    TYPE     zessvname,
        dudat    TYPE     zessdudat,
        stext    TYPE     zesstext,
        curky    TYPE     zesscurky,
        rgdat    TYPE     zessrgdat,
        rgtor    TYPE     zessrgtor,
        ename    TYPE     zessename,
        toprc    TYPE     zesspoprc,
*CURRENCY TYPE C LENGTH 24,
        currency TYPE    char30,
      END OF gs_cond_head.

*DATA: BEGIN OF gs_cond_head.
*      include STRUCTURE zsssmm0103.
*      data : currency type c LENGTH 24,
*end of gs_cond_head.

" 구매오더 아이템
TABLES : zsssmm0104.
DATA : gs_cond_item TYPE zsssmm0104.

" 구매오더 아이템 결과
DATA : gt_item TYPE zsssmm0104_t,
       gs_item LIKE LINE OF gt_item.


" 200번 스크린 alv 상세 조건 설정
DATA : go_con2 TYPE REF TO cl_gui_custom_container,
       go_alv2 TYPE REF TO cl_gui_alv_grid.

DATA : gs_layo2 TYPE lvc_s_layo,
       gt_fcat2 TYPE lvc_t_fcat,
       gs_fcat2 TYPE lvc_s_fcat,
       gt_sort2 TYPE lvc_t_sort,
       gs_sort2 TYPE lvc_s_sort.


* PO 채번 변수 - 추후 지역변수화 해도 됨
DATA : gv_po_num  TYPE c LENGTH 11.


" PO item - 넘버링 변수
DATA : gv_item_num TYPE n LENGTH 3.
DATA : gv_temp_num TYPE i.
DATA : gv_ven_screen TYPE string.


*-------------------------------------------------------*
* 300번 스크린 관련 변수들 & 구매오더 수정
*-------------------------------------------------------*
CONTROLS i_info TYPE TABSTRIP.

" 300번 스크린 alv 상세 조건 설정
DATA : go_con3 TYPE REF TO cl_gui_custom_container,
       go_alv3 TYPE REF TO cl_gui_alv_grid.

DATA : gs_layo3 TYPE lvc_s_layo,
       gt_fcat3 TYPE lvc_t_fcat,
       gs_fcat3 TYPE lvc_s_fcat,
       gt_sort3 TYPE lvc_t_sort,
       gs_sort3 TYPE lvc_s_sort.


" 302번 스크린 alv 상세 조건
DATA : go_con32 TYPE REF TO cl_gui_custom_container,
       go_alv32 TYPE REF TO cl_gui_alv_grid.

DATA : gs_layo32 TYPE lvc_s_layo,
       gt_fcat32 TYPE lvc_t_fcat,
       gs_fcat32 TYPE lvc_s_fcat,
       gt_sort32 TYPE lvc_t_sort,
       gs_sort32 TYPE lvc_s_sort.

DATA : gt_proto_item LIKE gt_item.


*-------------------------------------------------------*
* 400번 스크린 관련 변수들
*-------------------------------------------------------*

CONTROLS t_info TYPE TABSTRIP.

" 400번 스크린 alv 상세 조건 설정
DATA : go_con4 TYPE REF TO cl_gui_custom_container,
       go_alv4 TYPE REF TO cl_gui_alv_grid.

DATA : gs_layo4 TYPE lvc_s_layo,
       gt_fcat4 TYPE lvc_t_fcat,
       gs_fcat4 TYPE lvc_s_fcat,
       gt_sort4 TYPE lvc_t_sort,
       gs_sort4 TYPE lvc_s_sort.

DATA : gv_total_price TYPE i.

TABLES : zsssmd0302.

" 추후 스트럭쳐로 변경예정! => 벤더-가격정보
DATA : gt_prcat LIKE TABLE OF zsssmm0105,
       gs_prcat LIKE LINE OF gt_prcat.

DATA : go_con5 TYPE REF TO cl_gui_custom_container,
       go_alv5 TYPE REF TO cl_gui_alv_grid.

DATA : gs_layo5 TYPE lvc_s_layo,
       gt_fcat5 TYPE lvc_t_fcat,
       gs_fcat5 TYPE lvc_s_fcat,
       gt_sort5 TYPE lvc_t_sort,
       gs_sort5 TYPE lvc_s_sort.


" field - catalog types

TYPES : BEGIN OF ty_field_conf,
          grid_id    TYPE c LENGTH 2,
          fieldname  TYPE lvc_fname,
          coltext    TYPE scrtext_l,
          scrtext_s  TYPE scrtext_s,     " 짧은 텍스트
          scrtext_m  TYPE scrtext_m,     " 중간 텍스트
          scrtext_l  TYPE scrtext_l,     " 긴 텍스트
          outputlen  TYPE lvc_outlen,    " 컬럼 너비
          icon       TYPE c,             " 아이콘 여부
          just       TYPE lvc_just,      " 정렬 (L/C/R)
          emphasize  TYPE lvc_emphsz,    " 강조 색상
          key        TYPE c,             " 키 필드 여부
          intlen     TYPE i,  " ← 추가
          fix_column TYPE c,           " ← 추가
          no_out     TYPE c,             " 숨김
          edit       TYPE c,             " 편집 가능
          hotspot    TYPE c,             " 핫스팟
          checkbox   TYPE c,             " 체크박스
          style      TYPE lvc_style,
          col_pos    TYPE i,
          lzero      TYPE c,
          do_sum     TYPE lvc_dosum,
        END OF ty_field_conf. " 프로그램 타입

TYPES : ty_t_field_conf TYPE TABLE OF ty_field_conf.

*-------------------------------------------------------*
* class
*-------------------------------------------------------*

CLASS lcl_event_handler DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS on_double_click FOR EVENT double_click OF cl_gui_alv_grid IMPORTING e_column es_row_no.

ENDCLASS.

*DATA go_handler TYPE REF TO lcl_event_handler.
DATA go_handler2 TYPE REF TO lcl_event_handler.











*-------------------------------------------------------*
* Demo - Define macro
*-------------------------------------------------------*

*DEFINE _append_range.
*  FIELD-SYMBOLS <fs_range> LIKE LINE OF &1.
*  APPEND INITIAL LINE TO &1 ASSIGNING <fs_range>.
*  <fs_range>-sign = &2.
*  <fs_range>-option = &3.
*  <fs_range>-low = &4.
*  <fs_range>-high = &5.
*END-OF-DEFINITION.

----------------------------------------------------------------------------------
Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750
